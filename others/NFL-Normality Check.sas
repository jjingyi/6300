OPTIONS PAGENO=1;
TITLE1 'NFL';
TITLE2 'CHECK NORMALITY';
Data NFL;
input PCT YDSATT TD INT;
datalines;
68.3	9.25	45	0.012
71.2	8.34	46	0.021
65.6	8.57	39	0.020
66.3	8.02	31	0.019
63.5	7.6	    41	0.024
61	    8.49	15	0.021
61  	8.38	29	0.027
61.3	7.38	29	0.021
61.3	7.07	17	0.011
63.2	7.95	21	0.027
62.9	7.95	27	0.034
60.5	7.2 	16	0.026
58  	7.39	13	0.022
59.8	7.81	18	0.033
60  	7.84	21	0.033
61.6	6.89	18	0.027
57.7	7.73	9	0.032
57.6	6.66	20	0.022
60.7	8.39	13	0.049
58.1	6.59	20	0.025
60.2	6.87	14	0.029
62  	6.74	24	0.040
56.7	6.4 	26	0.033
59.5	6.98	9	0.036
59.5	6.37	10	0.033
62.8	6.52	16	0.040
57.2	5.9 	14	0.024
46.5	6.38	12	0.022
57.9	6.88	16	0.044
53.5	6.06	6	0.017
54.3	6.37	13	0.045
54.9	6.96	11	0.051
54.3	6.34	6	0.037
50.8	5.36	12	0.027
;
PROC CORR DATA=NFL COV PLOT=MATRIX();
 VAR PCT--INT; RUN;
proc print data=NFL;
run;
*Use scatter plots to check the normality assumption;
PROC GPLOT DATA=NFL;
 PLOT PCT*YDSATT;
 PLOT PCT*TD;
 PLOT PCT*INT;
 PLOT YDSATT*TD;
 PLOT YDSATT*INT;
 PLOT TD*INT;
RUN;
*CHECK MULTIVARIATE NORMALITY BY MAX(DI)^2;
PROC IML;
 USE NFL;
 READ ALL INTO Y;
 N=NROW(Y);
 YBAR=1/N*Y`*J(N,1);  				
 S=1/(N-1)*Y`*(I(N)-1/N*J(N))*Y;   	
 SINV=INV(S);   					
 YB=YBAR*J(1,N,1);  				
 YD=Y-YB`;   						
 DSQ=YD*SINV*YD`;  					
  D=DIAG(DSQ);  						
 D2=D*J(N,1,1); 					
 CREATE NFLD FROM D2[COLNAME='D2'];  
 APPEND from D2;
DATA NFLD;SET NFLD;
PROC SORT; BY D2;
PROC PRINT DATA=NFLD; RUN;
DATA NFLD; SET NFLD;
 N=100; P=4;
 U=N*D2/(N-1)**2;
 A=P/2;
 B=(N-P-1)/2;
 ALPHA=(P-2)/(2*P);
 BETA=(N-P-3)/(2*(N-P-1));
 PR=(_N_-ALPHA)/(N-ALPHA-BETA+1);
 V=BETAINV(PR,A,B);
RUN;
PROC GPLOT DATA=NFLD;
 PLOT U*V=1;
 SYMBOL1 C=RED V=STAR I=RL;
PROC CORR DATA=NFLD;
 VAR U V;
RUN;
*UNIVARIATE NORMALIT CHECK;
PROC UNIVARIATE NORMAL PLOT DATA=NFL;
 VAR PCT--INT; 
RUN;
